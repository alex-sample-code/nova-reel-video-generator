# 🎬 AI视频生成器 v2.0

基于AWS Bedrock的AI视频生成器，支持自动刷新的异步视频生成和**智能图片选择顺序**功能。

## ✨ 功能特色

### 🎯 核心功能 (v2.0 新增)
- 🔢 **图片选择顺序** - 记录选择顺序，确保视频连贯性
- 🎯 **数字标记显示** - 直观的圆形数字标记（①②③...）
- 🎨 **智能状态管理** - 实时状态反馈和警告提示
- 📱 **优雅界面设计** - 响应式布局和动画效果

### 🚀 原有功能
- 🔄 **自动刷新**: 每5秒自动检查生成状态，无需手动操作
- 🎥 **多镜头视频**: 支持1-8张图片生成连贯的多镜头视频
- 🎨 **多种风格**: 12种不同的视频风格可选
- ⚡ **异步生成**: 后台生成，不阻塞界面操作
- 🎯 **智能停止**: 完成或失败时自动停止刷新

## 🆕 v2.0 新功能详解

### 🎯 图片选择顺序系统
- **智能排序**: 按用户点击顺序记录图片选择
- **数字标记**: 选中图片显示蓝色圆形数字标记
- **顺序传递**: 按选择顺序传递给后端，确保视频连贯性
- **灵活调整**: 点击已选图片可取消选择，自动重新排序

### 🎨 视觉反馈系统
- **状态栏**: 实时显示"已选择 X/8 张图片"
- **警告提示**: 智能提示系统，3秒自动消失
- **禁用状态**: 达到上限时其他图片自动变灰
- **悬停效果**: 丰富的交互反馈和动画

### ⚡ 性能优化
- **防抖处理**: 避免频繁更新，提升响应速度
- **结果缓存**: 智能缓存机制，减少重复计算
- **批量更新**: 优化组件更新，提升界面流畅度
- **响应式设计**: 完美适配移动端和桌面端

## 🏗️ 项目结构

```
video-generator/
├── app.py                 # 主应用入口
├── start.sh              # 启动脚本
├── requirements.txt       # Python依赖
├── README.md             # 项目说明
├── .env.example          # 环境变量模板
├── check_status.py       # 状态检查工具
├── backend/              # 后端逻辑
│   ├── aws_client.py     # AWS Bedrock客户端
│   ├── video_generator.py # 视频生成核心逻辑
│   └── prompt_generator.py # 提示词生成
├── images/               # 预设图片
│   ├── nature/           # 自然风景图片
│   └── animals/          # 动物图片
├── generated_videos/     # 生成的视频存储
├── image_selection_manager.py  # 图片选择状态管理器 (v2.0新增)
└── templates/            # 配置模板
    └── style_prompts.json # 风格提示词模板
```

## 🎯 使用流程 (v2.0 优化)

### 新的交互体验
1. **选择分类**: 从nature或animals中选择一个分类
2. **选择风格**: 从12种风格中选择
3. **按顺序选择图片**: 点击图片按想要的顺序选择（显示数字标记）
4. **实时状态反馈**: 查看选择状态和警告提示
5. **开始生成**: 点击"开始生成视频"按钮
6. **自动等待**: 系统会自动刷新状态，无需手动操作
7. **查看结果**: 生成完成后视频会自动显示

### 🎨 交互特色
- **点击选择**: 单击图片选择，显示蓝色数字标记
- **再次点击取消**: 点击已选择的图片可取消选择
- **自动重排**: 取消选择后，后续数字自动重新排序
- **智能禁用**: 选择8张后，其他图片自动变为禁用状态
- **悬停提示**: 鼠标悬停显示操作提示

## 🚀 快速开始

### 1. 环境准备

```bash
# 配置AWS凭证
aws configure
# 或设置环境变量
cp .env.example .env
# 编辑.env文件，填入你的AWS凭证
```

### 2. 启动应用

```bash
# 使用启动脚本（推荐）
./start.sh

# 或直接运行
source .venv/bin/activate
python app.py
```

应用将在 **http://localhost:7861** 启动

## 🔄 自动刷新功能

### 工作原理
1. **开始生成** → 自动激活定时器，每5秒检查一次状态
2. **生成中** → 显示实时状态和时间戳
3. **完成/失败** → 自动停止刷新，显示结果

### 状态显示
- **🚀 开始生成**: 显示任务信息，激活自动刷新
- **⏳ 生成中**: 实时显示进度和时间戳
- **🎉 生成完成**: 显示视频，停止自动刷新
- **❌ 生成失败**: 显示错误信息，停止自动刷新

## 🎯 使用流程

1. **选择分类**: 从nature或animals中选择一个分类
2. **选择风格**: 从12种风格中选择
3. **选择图片**: 勾选1-8张图片
4. **开始生成**: 点击"开始生成视频"按钮
5. **自动等待**: 系统会自动刷新状态，无需手动操作
6. **查看结果**: 生成完成后视频会自动显示

## 可用的视频风格

### 情感风格
- 平静的 - 宁静祥和的视频效果
- 动感的 - 充满活力的动态效果
- 梦幻的 - 如梦如幻的魔幻效果
- 神秘的 - 神秘莫测的氛围效果
- 温馨的 - 温暖人心的亲密效果

### 视觉效果
- 电影感 - 专业电影级别的视觉效果
- 纪录片风格 - 真实自然的纪录片风格
- 艺术风格 - 富有创意的艺术表现
- 自然风格 - 展现自然环境之美

### 节奏控制
- 缓慢渐变 - 平缓流畅的过渡效果
- 快速切换 - 快节奏的动态切换
- 节奏感强 - 富有韵律的同步效果

## 技术架构

- **前端**: Gradio Web界面
- **后端**: Python + AWS Bedrock
- **AI模型**: 
  - Claude Sonnet 3.5 (提示词生成)
  - Amazon Nova Reel (视频生成，支持异步调用)
- **存储**: 本地文件系统
- **异步支持**: 使用AWS Bedrock异步API，支持后台生成和状态轮询

## 🛠️ 工具命令

### 检查任务状态
```bash
python check_status.py
```

## 注意事项

1. **AWS权限**: 确保AWS账户有访问Bedrock服务的权限
2. **模型访问**: 需要在AWS控制台中启用Claude和Nova Reel模型
3. **费用**: 使用AWS Bedrock会产生费用，请注意用量
4. **文件大小**: 生成的视频文件较大，注意存储空间
5. **网络**: 视频生成需要稳定的网络连接

## 故障排除

### 常见问题

1. **自动刷新不工作**
   - 确保页面保持活跃状态
   - 检查浏览器控制台是否有错误
   - 尝试手动检查状态

2. **AWS凭证错误**
   - 检查AWS凭证配置
   - 确认账户权限

3. **模型访问被拒绝**
   - 在AWS Bedrock控制台启用相应模型
   - 检查区域设置

4. **图片加载失败**
   - 确认images目录结构正确
   - 检查图片文件格式

5. **视频生成超时**
   - 检查网络连接
   - 减少选择的图片数量

## 许可证

本项目仅用于演示和学习目的。
